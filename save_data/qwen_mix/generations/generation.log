2025-09-19 01:10:25,831 - INFO - Starting generation script with arguments:
2025-09-19 01:10:25,831 - INFO -   input_file: data/test_all.jsonl
2025-09-19 01:10:25,831 - INFO -   output_dir: output/generations/
2025-09-19 01:10:25,831 - INFO -   few_shot_dir: few_shots
2025-09-19 01:10:25,831 - INFO -   model: models/generator
2025-09-19 01:10:25,831 - INFO -   system_prompt: You are a SQLite expert tasked with writing SQL for a given natural language user query. You would be given database information in form of CREATE TABLE statements; External Knowledge which are hints; user natural language query. Your task is to write valid SQLite to answer the user questions for the tables provided.
2025-09-19 01:10:25,832 - INFO -   batch_size: 1024
2025-09-19 01:10:25,832 - INFO -   num_samples_per_prompt: 16
2025-09-19 01:10:25,832 - INFO -   num_prompts_per_query: 16
2025-09-19 01:10:25,832 - INFO -   num_shots: 1
2025-09-19 01:10:25,832 - INFO -   max_tokens: 1024
2025-09-19 01:10:25,832 - INFO -   seed: 42
2025-09-19 01:10:25,832 - INFO -   temperature: 1.0
2025-09-19 01:10:25,832 - INFO -   num_gpus: 1
2025-09-19 01:10:25,832 - INFO -   start_from_scratch: False
2025-09-19 01:10:25,832 - INFO -   stop: [';', '<pad>', '<|endoftext|>', '</s>', '<|im_end|>']
2025-09-19 01:10:25,832 - INFO -   num_partitions: 1
2025-09-19 01:10:25,832 - INFO -   partition_index: 0
2025-09-19 01:10:25,832 - INFO - Reading input data...
2025-09-19 01:10:25,833 - INFO - Data size after partitioning: 500 items (partition 1 of 1)
2025-09-19 01:10:25,854 - INFO - Read 7428 few-shot examples from few_shots
2025-09-19 01:10:25,854 - INFO - Output file path: output/generations/data_gen.jsonl
2025-09-19 01:10:25,854 - INFO - No existing progress to resume from. Starting from scratch.
2025-09-19 01:10:25,854 - INFO - Initializing model and tokenizer...
2025-09-19 01:10:38,414 - DEBUG - Starting new HTTPS connection (1): stats.vllm.ai:443
2025-09-19 01:10:38,689 - DEBUG - https://stats.vllm.ai:443 "POST / HTTP/1.1" 200 None
2025-09-19 01:11:37,639 - INFO - Model and tokenizer initialized.
2025-09-19 01:11:37,640 - DEBUG - Fast-forwarding random seed for 0 iterations...
2025-09-19 01:11:37,641 - DEBUG - Done fast-forwarding random state.
2025-09-19 01:11:37,641 - INFO - === Starting iteration 0 / 15 ===
2025-09-19 01:11:37,642 - DEBUG - Sampled few-shot indices: 5238
2025-09-19 01:11:37,642 - INFO - Generated 1 few-shot messages using indices 5238
2025-09-19 01:11:37,643 - INFO - Generating batch from data index 0 to 499...
2025-09-19 01:11:37,643 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 01:11:37,766 - DEBUG - Running generation on the batch...
2025-09-19 01:17:44,850 - DEBUG - Generation for this batch completed.
2025-09-19 01:17:45,264 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 01:17:45,264 - INFO - Progress saved: iteration=0, next data index=500
2025-09-19 01:17:45,264 - INFO - Completed iteration 0
2025-09-19 01:17:45,264 - INFO - === Starting iteration 1 / 15 ===
2025-09-19 01:17:45,264 - DEBUG - Sampled few-shot indices: 912
2025-09-19 01:17:45,265 - INFO - Generated 1 few-shot messages using indices 912
2025-09-19 01:17:45,265 - INFO - Generating batch from data index 0 to 499...
2025-09-19 01:17:45,265 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 01:17:45,318 - DEBUG - Running generation on the batch...
2025-09-19 01:20:38,793 - DEBUG - Resetting dropped connection: stats.vllm.ai
2025-09-19 01:20:39,001 - DEBUG - https://stats.vllm.ai:443 "POST / HTTP/1.1" 200 None
2025-09-19 01:24:34,235 - DEBUG - Generation for this batch completed.
2025-09-19 01:24:34,677 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 01:24:34,677 - INFO - Progress saved: iteration=1, next data index=500
2025-09-19 01:24:34,677 - INFO - Completed iteration 1
2025-09-19 01:24:34,678 - INFO - === Starting iteration 2 / 15 ===
2025-09-19 01:24:34,678 - DEBUG - Sampled few-shot indices: 204
2025-09-19 01:24:34,678 - INFO - Generated 1 few-shot messages using indices 204
2025-09-19 01:24:34,678 - INFO - Generating batch from data index 0 to 499...
2025-09-19 01:24:34,678 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 01:24:34,730 - DEBUG - Running generation on the batch...
2025-09-19 01:30:39,104 - DEBUG - Resetting dropped connection: stats.vllm.ai
2025-09-19 01:30:39,313 - DEBUG - https://stats.vllm.ai:443 "POST / HTTP/1.1" 200 None
2025-09-19 01:31:05,538 - DEBUG - Generation for this batch completed.
2025-09-19 01:31:05,957 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 01:31:05,957 - INFO - Progress saved: iteration=2, next data index=500
2025-09-19 01:31:05,957 - INFO - Completed iteration 2
2025-09-19 01:31:05,957 - INFO - === Starting iteration 3 / 15 ===
2025-09-19 01:31:05,958 - DEBUG - Sampled few-shot indices: 6074
2025-09-19 01:31:05,958 - INFO - Generated 1 few-shot messages using indices 6074
2025-09-19 01:31:05,958 - INFO - Generating batch from data index 0 to 499...
2025-09-19 01:31:05,958 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 01:31:06,011 - DEBUG - Running generation on the batch...
2025-09-19 01:37:22,333 - DEBUG - Generation for this batch completed.
2025-09-19 01:37:22,764 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 01:37:22,764 - INFO - Progress saved: iteration=3, next data index=500
2025-09-19 01:37:22,764 - INFO - Completed iteration 3
2025-09-19 01:37:22,764 - INFO - === Starting iteration 4 / 15 ===
2025-09-19 01:37:22,765 - DEBUG - Sampled few-shot indices: 2253
2025-09-19 01:37:22,765 - INFO - Generated 1 few-shot messages using indices 2253
2025-09-19 01:37:22,765 - INFO - Generating batch from data index 0 to 499...
2025-09-19 01:37:22,765 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 01:37:22,819 - DEBUG - Running generation on the batch...
2025-09-19 01:40:39,417 - DEBUG - Resetting dropped connection: stats.vllm.ai
2025-09-19 01:40:39,768 - DEBUG - https://stats.vllm.ai:443 "POST / HTTP/1.1" 200 None
2025-09-19 01:44:02,201 - DEBUG - Generation for this batch completed.
2025-09-19 01:44:02,654 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 01:44:02,654 - INFO - Progress saved: iteration=4, next data index=500
2025-09-19 01:44:02,655 - INFO - Completed iteration 4
2025-09-19 01:44:02,655 - INFO - === Starting iteration 5 / 15 ===
2025-09-19 01:44:02,655 - DEBUG - Sampled few-shot indices: 2006
2025-09-19 01:44:02,655 - INFO - Generated 1 few-shot messages using indices 2006
2025-09-19 01:44:02,655 - INFO - Generating batch from data index 0 to 499...
2025-09-19 01:44:02,655 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 01:44:02,708 - DEBUG - Running generation on the batch...
2025-09-19 01:50:33,235 - DEBUG - Generation for this batch completed.
2025-09-19 01:50:33,794 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 01:50:33,795 - INFO - Progress saved: iteration=5, next data index=500
2025-09-19 01:50:33,795 - INFO - Completed iteration 5
2025-09-19 01:50:33,795 - INFO - === Starting iteration 6 / 15 ===
2025-09-19 01:50:33,795 - DEBUG - Sampled few-shot indices: 1828
2025-09-19 01:50:33,796 - INFO - Generated 1 few-shot messages using indices 1828
2025-09-19 01:50:33,796 - INFO - Generating batch from data index 0 to 499...
2025-09-19 01:50:33,796 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 01:50:33,848 - DEBUG - Running generation on the batch...
2025-09-19 01:50:40,164 - DEBUG - Resetting dropped connection: stats.vllm.ai
2025-09-19 01:50:40,420 - DEBUG - https://stats.vllm.ai:443 "POST / HTTP/1.1" 200 None
2025-09-19 01:56:55,566 - DEBUG - Generation for this batch completed.
2025-09-19 01:56:55,964 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 01:56:55,965 - INFO - Progress saved: iteration=6, next data index=500
2025-09-19 01:56:55,965 - INFO - Completed iteration 6
2025-09-19 01:56:55,965 - INFO - === Starting iteration 7 / 15 ===
2025-09-19 01:56:55,965 - DEBUG - Sampled few-shot indices: 1143
2025-09-19 01:56:55,965 - INFO - Generated 1 few-shot messages using indices 1143
2025-09-19 01:56:55,965 - INFO - Generating batch from data index 0 to 499...
2025-09-19 01:56:55,965 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 01:56:56,016 - DEBUG - Running generation on the batch...
2025-09-19 02:00:40,524 - DEBUG - Resetting dropped connection: stats.vllm.ai
2025-09-19 02:00:40,727 - DEBUG - https://stats.vllm.ai:443 "POST / HTTP/1.1" 200 None
2025-09-19 02:03:11,599 - DEBUG - Generation for this batch completed.
2025-09-19 02:03:12,001 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 02:03:12,002 - INFO - Progress saved: iteration=7, next data index=500
2025-09-19 02:03:12,002 - INFO - Completed iteration 7
2025-09-19 02:03:12,002 - INFO - === Starting iteration 8 / 15 ===
2025-09-19 02:03:12,002 - DEBUG - Sampled few-shot indices: 6033
2025-09-19 02:03:12,002 - INFO - Generated 1 few-shot messages using indices 6033
2025-09-19 02:03:12,002 - INFO - Generating batch from data index 0 to 499...
2025-09-19 02:03:12,002 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 02:03:12,055 - DEBUG - Running generation on the batch...
2025-09-19 02:09:42,920 - DEBUG - Generation for this batch completed.
2025-09-19 02:09:43,311 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 02:09:43,312 - INFO - Progress saved: iteration=8, next data index=500
2025-09-19 02:09:43,312 - INFO - Completed iteration 8
2025-09-19 02:09:43,312 - INFO - === Starting iteration 9 / 15 ===
2025-09-19 02:09:43,312 - DEBUG - Sampled few-shot indices: 839
2025-09-19 02:09:43,312 - INFO - Generated 1 few-shot messages using indices 839
2025-09-19 02:09:43,312 - INFO - Generating batch from data index 0 to 499...
2025-09-19 02:09:43,313 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 02:09:43,364 - DEBUG - Running generation on the batch...
2025-09-19 02:10:40,831 - DEBUG - Resetting dropped connection: stats.vllm.ai
2025-09-19 02:10:41,040 - DEBUG - https://stats.vllm.ai:443 "POST / HTTP/1.1" 200 None
2025-09-19 02:16:16,487 - DEBUG - Generation for this batch completed.
2025-09-19 02:16:16,910 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 02:16:16,911 - INFO - Progress saved: iteration=9, next data index=500
2025-09-19 02:16:16,911 - INFO - Completed iteration 9
2025-09-19 02:16:16,911 - INFO - === Starting iteration 10 / 15 ===
2025-09-19 02:16:16,911 - DEBUG - Sampled few-shot indices: 5543
2025-09-19 02:16:16,911 - INFO - Generated 1 few-shot messages using indices 5543
2025-09-19 02:16:16,911 - INFO - Generating batch from data index 0 to 499...
2025-09-19 02:16:16,912 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 02:16:16,963 - DEBUG - Running generation on the batch...
2025-09-19 02:20:41,073 - DEBUG - Resetting dropped connection: stats.vllm.ai
2025-09-19 02:20:41,264 - DEBUG - https://stats.vllm.ai:443 "POST / HTTP/1.1" 200 None
2025-09-19 02:22:40,744 - DEBUG - Generation for this batch completed.
2025-09-19 02:22:41,167 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 02:22:41,167 - INFO - Progress saved: iteration=10, next data index=500
2025-09-19 02:22:41,167 - INFO - Completed iteration 10
2025-09-19 02:22:41,167 - INFO - === Starting iteration 11 / 15 ===
2025-09-19 02:22:41,167 - DEBUG - Sampled few-shot indices: 6067
2025-09-19 02:22:41,168 - INFO - Generated 1 few-shot messages using indices 6067
2025-09-19 02:22:41,168 - INFO - Generating batch from data index 0 to 499...
2025-09-19 02:22:41,168 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 02:22:41,220 - DEBUG - Running generation on the batch...
2025-09-19 02:29:03,749 - DEBUG - Generation for this batch completed.
2025-09-19 02:29:04,168 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 02:29:04,168 - INFO - Progress saved: iteration=11, next data index=500
2025-09-19 02:29:04,168 - INFO - Completed iteration 11
2025-09-19 02:29:04,168 - INFO - === Starting iteration 12 / 15 ===
2025-09-19 02:29:04,169 - DEBUG - Sampled few-shot indices: 7308
2025-09-19 02:29:04,169 - INFO - Generated 1 few-shot messages using indices 7308
2025-09-19 02:29:04,169 - INFO - Generating batch from data index 0 to 499...
2025-09-19 02:29:04,169 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 02:29:04,222 - DEBUG - Running generation on the batch...
2025-09-19 02:30:41,367 - DEBUG - Resetting dropped connection: stats.vllm.ai
2025-09-19 02:30:41,621 - DEBUG - https://stats.vllm.ai:443 "POST / HTTP/1.1" 200 None
2025-09-19 02:35:40,606 - DEBUG - Generation for this batch completed.
2025-09-19 02:35:41,050 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 02:35:41,051 - INFO - Progress saved: iteration=12, next data index=500
2025-09-19 02:35:41,051 - INFO - Completed iteration 12
2025-09-19 02:35:41,051 - INFO - === Starting iteration 13 / 15 ===
2025-09-19 02:35:41,051 - DEBUG - Sampled few-shot indices: 4467
2025-09-19 02:35:41,051 - INFO - Generated 1 few-shot messages using indices 4467
2025-09-19 02:35:41,052 - INFO - Generating batch from data index 0 to 499...
2025-09-19 02:35:41,052 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 02:35:41,104 - DEBUG - Running generation on the batch...
2025-09-19 02:40:41,725 - DEBUG - Resetting dropped connection: stats.vllm.ai
2025-09-19 02:40:41,970 - DEBUG - https://stats.vllm.ai:443 "POST / HTTP/1.1" 200 None
2025-09-19 02:42:25,326 - DEBUG - Generation for this batch completed.
2025-09-19 02:42:25,741 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 02:42:25,742 - INFO - Progress saved: iteration=13, next data index=500
2025-09-19 02:42:25,742 - INFO - Completed iteration 13
2025-09-19 02:42:25,742 - INFO - === Starting iteration 14 / 15 ===
2025-09-19 02:42:25,742 - DEBUG - Sampled few-shot indices: 712
2025-09-19 02:42:25,742 - INFO - Generated 1 few-shot messages using indices 712
2025-09-19 02:42:25,742 - INFO - Generating batch from data index 0 to 499...
2025-09-19 02:42:25,743 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 02:42:25,795 - DEBUG - Running generation on the batch...
2025-09-19 02:48:55,200 - DEBUG - Generation for this batch completed.
2025-09-19 02:48:55,588 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 02:48:55,588 - INFO - Progress saved: iteration=14, next data index=500
2025-09-19 02:48:55,588 - INFO - Completed iteration 14
2025-09-19 02:48:55,588 - INFO - === Starting iteration 15 / 15 ===
2025-09-19 02:48:55,588 - DEBUG - Sampled few-shot indices: 4837
2025-09-19 02:48:55,589 - INFO - Generated 1 few-shot messages using indices 4837
2025-09-19 02:48:55,589 - INFO - Generating batch from data index 0 to 499...
2025-09-19 02:48:55,589 - DEBUG - Preparing prompts for a batch of 500 items.
2025-09-19 02:48:55,640 - DEBUG - Running generation on the batch...
2025-09-19 02:50:42,074 - DEBUG - Resetting dropped connection: stats.vllm.ai
2025-09-19 02:50:42,275 - DEBUG - https://stats.vllm.ai:443 "POST / HTTP/1.1" 200 None
2025-09-19 02:55:21,558 - DEBUG - Generation for this batch completed.
2025-09-19 02:55:21,966 - INFO - Appended 500 items to output/generations/data_gen.jsonl
2025-09-19 02:55:21,966 - INFO - Progress saved: iteration=15, next data index=500
2025-09-19 02:55:21,966 - INFO - Completed iteration 15
2025-09-19 02:55:21,966 - INFO - All generations completed!
2025-09-19 02:55:21,966 - INFO - Exiting script.
