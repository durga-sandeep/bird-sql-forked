2025-09-20 22:15:20,141 - INFO - Starting generation script with arguments:
2025-09-20 22:15:20,141 - INFO -   input_file: data/test_all.jsonl
2025-09-20 22:15:20,141 - INFO -   output_dir: output/generations/
2025-09-20 22:15:20,141 - INFO -   few_shot_dir: few_shots
2025-09-20 22:15:20,141 - INFO -   model: models/generator
2025-09-20 22:15:20,141 - INFO -   system_prompt: You are a SQLite expert tasked with writing SQL for a given natural language user query. You would be given database information in form of CREATE TABLE statements; External Knowledge which are hints; user natural language query. Your task is to write valid SQLite to answer the user questions for the tables provided.
2025-09-20 22:15:20,141 - INFO -   batch_size: 256
2025-09-20 22:15:20,141 - INFO -   num_samples_per_prompt: 16
2025-09-20 22:15:20,141 - INFO -   num_prompts_per_query: 16
2025-09-20 22:15:20,141 - INFO -   num_shots: 1
2025-09-20 22:15:20,141 - INFO -   max_tokens: 1024
2025-09-20 22:15:20,141 - INFO -   seed: 42
2025-09-20 22:15:20,141 - INFO -   temperature: 1.0
2025-09-20 22:15:20,141 - INFO -   num_gpus: 1
2025-09-20 22:15:20,141 - INFO -   start_from_scratch: False
2025-09-20 22:15:20,141 - INFO -   stop: [';', '<pad>', '<|endoftext|>', '</s>', '<|im_end|>']
2025-09-20 22:15:20,141 - INFO -   num_partitions: 1
2025-09-20 22:15:20,141 - INFO -   partition_index: 0
2025-09-20 22:15:20,141 - INFO -   use_schema_linking: True
2025-09-20 22:15:20,141 - INFO -   include_columns_linking: True
2025-09-20 22:15:20,141 - INFO - Reading input data...
2025-09-20 22:15:20,141 - INFO - Data size after partitioning: 30 items (partition 1 of 1)
2025-09-20 22:15:20,163 - INFO - Read 7428 few-shot examples from few_shots
2025-09-20 22:15:20,163 - INFO - Output file path: output/generations/data_gen.jsonl
2025-09-20 22:15:20,163 - INFO - No existing progress to resume from. Starting from scratch.
2025-09-20 22:15:20,163 - INFO - Initializing model and tokenizer...
2025-09-20 22:15:31,763 - DEBUG - Starting new HTTPS connection (1): stats.vllm.ai:443
2025-09-20 22:15:31,926 - DEBUG - https://stats.vllm.ai:443 "POST / HTTP/1.1" 200 None
2025-09-20 22:16:43,166 - INFO - Model and tokenizer initialized.
2025-09-20 22:16:43,167 - DEBUG - Fast-forwarding random seed for 0 iterations...
2025-09-20 22:16:43,167 - DEBUG - Done fast-forwarding random state.
2025-09-20 22:16:43,168 - INFO - === Starting iteration 0 / 15 ===
2025-09-20 22:16:43,169 - DEBUG - Sampled few-shot indices: 5238
2025-09-20 22:16:43,169 - INFO - Generated 1 few-shot messages using indices 5238
2025-09-20 22:16:43,169 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:16:43,170 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:16:46,794 - DEBUG - Running generation on the batch...
2025-09-20 22:17:03,525 - DEBUG - Generation for this batch completed.
2025-09-20 22:17:03,560 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:17:03,560 - INFO - Progress saved: iteration=0, next data index=30
2025-09-20 22:17:03,560 - INFO - Completed iteration 0
2025-09-20 22:17:03,560 - INFO - === Starting iteration 1 / 15 ===
2025-09-20 22:17:03,561 - DEBUG - Sampled few-shot indices: 912
2025-09-20 22:17:03,561 - INFO - Generated 1 few-shot messages using indices 912
2025-09-20 22:17:03,561 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:17:03,562 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:17:07,036 - DEBUG - Running generation on the batch...
2025-09-20 22:17:26,397 - DEBUG - Generation for this batch completed.
2025-09-20 22:17:26,435 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:17:26,436 - INFO - Progress saved: iteration=1, next data index=30
2025-09-20 22:17:26,436 - INFO - Completed iteration 1
2025-09-20 22:17:26,436 - INFO - === Starting iteration 2 / 15 ===
2025-09-20 22:17:26,437 - DEBUG - Sampled few-shot indices: 204
2025-09-20 22:17:26,437 - INFO - Generated 1 few-shot messages using indices 204
2025-09-20 22:17:26,437 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:17:26,437 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:17:30,226 - DEBUG - Running generation on the batch...
2025-09-20 22:17:53,778 - DEBUG - Generation for this batch completed.
2025-09-20 22:17:53,816 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:17:53,816 - INFO - Progress saved: iteration=2, next data index=30
2025-09-20 22:17:53,816 - INFO - Completed iteration 2
2025-09-20 22:17:53,817 - INFO - === Starting iteration 3 / 15 ===
2025-09-20 22:17:53,817 - DEBUG - Sampled few-shot indices: 6074
2025-09-20 22:17:53,818 - INFO - Generated 1 few-shot messages using indices 6074
2025-09-20 22:17:53,818 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:17:53,818 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:17:57,594 - DEBUG - Running generation on the batch...
2025-09-20 22:18:13,292 - DEBUG - Generation for this batch completed.
2025-09-20 22:18:13,329 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:18:13,329 - INFO - Progress saved: iteration=3, next data index=30
2025-09-20 22:18:13,329 - INFO - Completed iteration 3
2025-09-20 22:18:13,330 - INFO - === Starting iteration 4 / 15 ===
2025-09-20 22:18:13,330 - DEBUG - Sampled few-shot indices: 2253
2025-09-20 22:18:13,331 - INFO - Generated 1 few-shot messages using indices 2253
2025-09-20 22:18:13,331 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:18:13,331 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:18:16,813 - DEBUG - Running generation on the batch...
2025-09-20 22:18:37,556 - DEBUG - Generation for this batch completed.
2025-09-20 22:18:37,593 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:18:37,594 - INFO - Progress saved: iteration=4, next data index=30
2025-09-20 22:18:37,594 - INFO - Completed iteration 4
2025-09-20 22:18:37,594 - INFO - === Starting iteration 5 / 15 ===
2025-09-20 22:18:37,595 - DEBUG - Sampled few-shot indices: 2006
2025-09-20 22:18:37,596 - INFO - Generated 1 few-shot messages using indices 2006
2025-09-20 22:18:37,596 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:18:37,596 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:18:41,397 - DEBUG - Running generation on the batch...
2025-09-20 22:18:57,961 - DEBUG - Generation for this batch completed.
2025-09-20 22:18:57,998 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:18:57,999 - INFO - Progress saved: iteration=5, next data index=30
2025-09-20 22:18:57,999 - INFO - Completed iteration 5
2025-09-20 22:18:57,999 - INFO - === Starting iteration 6 / 15 ===
2025-09-20 22:18:58,000 - DEBUG - Sampled few-shot indices: 1828
2025-09-20 22:18:58,000 - INFO - Generated 1 few-shot messages using indices 1828
2025-09-20 22:18:58,000 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:18:58,000 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:19:01,486 - DEBUG - Running generation on the batch...
2025-09-20 22:19:18,289 - DEBUG - Generation for this batch completed.
2025-09-20 22:19:18,327 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:19:18,328 - INFO - Progress saved: iteration=6, next data index=30
2025-09-20 22:19:18,328 - INFO - Completed iteration 6
2025-09-20 22:19:18,328 - INFO - === Starting iteration 7 / 15 ===
2025-09-20 22:19:18,329 - DEBUG - Sampled few-shot indices: 1143
2025-09-20 22:19:18,329 - INFO - Generated 1 few-shot messages using indices 1143
2025-09-20 22:19:18,329 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:19:18,330 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:19:21,811 - DEBUG - Running generation on the batch...
2025-09-20 22:19:39,072 - DEBUG - Generation for this batch completed.
2025-09-20 22:19:39,108 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:19:39,109 - INFO - Progress saved: iteration=7, next data index=30
2025-09-20 22:19:39,109 - INFO - Completed iteration 7
2025-09-20 22:19:39,109 - INFO - === Starting iteration 8 / 15 ===
2025-09-20 22:19:39,110 - DEBUG - Sampled few-shot indices: 6033
2025-09-20 22:19:39,110 - INFO - Generated 1 few-shot messages using indices 6033
2025-09-20 22:19:39,110 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:19:39,110 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:19:42,584 - DEBUG - Running generation on the batch...
2025-09-20 22:19:59,295 - DEBUG - Generation for this batch completed.
2025-09-20 22:19:59,330 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:19:59,331 - INFO - Progress saved: iteration=8, next data index=30
2025-09-20 22:19:59,331 - INFO - Completed iteration 8
2025-09-20 22:19:59,331 - INFO - === Starting iteration 9 / 15 ===
2025-09-20 22:19:59,332 - DEBUG - Sampled few-shot indices: 839
2025-09-20 22:19:59,332 - INFO - Generated 1 few-shot messages using indices 839
2025-09-20 22:19:59,332 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:19:59,333 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:20:02,808 - DEBUG - Running generation on the batch...
2025-09-20 22:20:20,595 - DEBUG - Generation for this batch completed.
2025-09-20 22:20:20,634 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:20:20,634 - INFO - Progress saved: iteration=9, next data index=30
2025-09-20 22:20:20,635 - INFO - Completed iteration 9
2025-09-20 22:20:20,635 - INFO - === Starting iteration 10 / 15 ===
2025-09-20 22:20:20,635 - DEBUG - Sampled few-shot indices: 5543
2025-09-20 22:20:20,636 - INFO - Generated 1 few-shot messages using indices 5543
2025-09-20 22:20:20,636 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:20:20,636 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:20:24,119 - DEBUG - Running generation on the batch...
2025-09-20 22:20:42,237 - DEBUG - Generation for this batch completed.
2025-09-20 22:20:42,273 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:20:42,274 - INFO - Progress saved: iteration=10, next data index=30
2025-09-20 22:20:42,274 - INFO - Completed iteration 10
2025-09-20 22:20:42,274 - INFO - === Starting iteration 11 / 15 ===
2025-09-20 22:20:42,275 - DEBUG - Sampled few-shot indices: 6067
2025-09-20 22:20:42,275 - INFO - Generated 1 few-shot messages using indices 6067
2025-09-20 22:20:42,276 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:20:42,276 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:20:45,764 - DEBUG - Running generation on the batch...
2025-09-20 22:21:03,521 - DEBUG - Generation for this batch completed.
2025-09-20 22:21:03,557 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:21:03,558 - INFO - Progress saved: iteration=11, next data index=30
2025-09-20 22:21:03,558 - INFO - Completed iteration 11
2025-09-20 22:21:03,558 - INFO - === Starting iteration 12 / 15 ===
2025-09-20 22:21:03,559 - DEBUG - Sampled few-shot indices: 7308
2025-09-20 22:21:03,559 - INFO - Generated 1 few-shot messages using indices 7308
2025-09-20 22:21:03,559 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:21:03,559 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:21:07,048 - DEBUG - Running generation on the batch...
2025-09-20 22:21:26,837 - DEBUG - Generation for this batch completed.
2025-09-20 22:21:26,877 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:21:26,877 - INFO - Progress saved: iteration=12, next data index=30
2025-09-20 22:21:26,878 - INFO - Completed iteration 12
2025-09-20 22:21:26,878 - INFO - === Starting iteration 13 / 15 ===
2025-09-20 22:21:26,878 - DEBUG - Sampled few-shot indices: 4467
2025-09-20 22:21:26,879 - INFO - Generated 1 few-shot messages using indices 4467
2025-09-20 22:21:26,879 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:21:26,879 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:21:30,351 - DEBUG - Running generation on the batch...
2025-09-20 22:21:49,801 - DEBUG - Generation for this batch completed.
2025-09-20 22:21:49,839 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:21:49,840 - INFO - Progress saved: iteration=13, next data index=30
2025-09-20 22:21:49,840 - INFO - Completed iteration 13
2025-09-20 22:21:49,840 - INFO - === Starting iteration 14 / 15 ===
2025-09-20 22:21:49,841 - DEBUG - Sampled few-shot indices: 712
2025-09-20 22:21:49,841 - INFO - Generated 1 few-shot messages using indices 712
2025-09-20 22:21:49,841 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:21:49,841 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:21:53,340 - DEBUG - Running generation on the batch...
2025-09-20 22:22:10,303 - DEBUG - Generation for this batch completed.
2025-09-20 22:22:10,342 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:22:10,343 - INFO - Progress saved: iteration=14, next data index=30
2025-09-20 22:22:10,343 - INFO - Completed iteration 14
2025-09-20 22:22:10,343 - INFO - === Starting iteration 15 / 15 ===
2025-09-20 22:22:10,344 - DEBUG - Sampled few-shot indices: 4837
2025-09-20 22:22:10,344 - INFO - Generated 1 few-shot messages using indices 4837
2025-09-20 22:22:10,344 - INFO - Generating batch from data index 0 to 29...
2025-09-20 22:22:10,345 - DEBUG - Preparing prompts for a batch of 30 items.
2025-09-20 22:22:14,094 - DEBUG - Running generation on the batch...
2025-09-20 22:22:33,326 - DEBUG - Generation for this batch completed.
2025-09-20 22:22:33,364 - INFO - Appended 30 items to output/generations/data_gen.jsonl
2025-09-20 22:22:33,365 - INFO - Progress saved: iteration=15, next data index=30
2025-09-20 22:22:33,365 - INFO - Completed iteration 15
2025-09-20 22:22:33,365 - INFO - All generations completed!
2025-09-20 22:22:33,365 - INFO - Exiting script.
